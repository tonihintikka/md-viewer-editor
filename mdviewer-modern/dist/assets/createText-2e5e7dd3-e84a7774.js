import{H as t,aP as e,aR as n,aS as o}from"./index-7485a0e9.js";function r(t){const e=function(t){const e=t.replace(/\n{2,}/g,"\n");return o(e)}(t),{children:r}=n(e),s=[[]];let a=0;function l(t,e="normal"){if("text"===t.type){t.value.split("\n").forEach(((t,n)=>{0!==n&&(a++,s.push([])),t.split(" ").forEach((t=>{t&&s[a].push({content:t,type:e})}))}))}else"strong"!==t.type&&"emphasis"!==t.type||t.children.forEach((e=>{l(e,t.type)}))}return r.forEach((t=>{"paragraph"===t.type&&t.children.forEach((t=>{l(t)}))})),s}function s(t,e){var n;return a(t,[],(n=e.content,Intl.Segmenter?[...(new Intl.Segmenter).segment(n)].map((t=>t.segment)):[...n]),e.type)}function a(t,e,n,o){if(0===n.length)return[{content:e.join(""),type:o},{content:"",type:o}];const[r,...s]=n,l=[...e,r];return t([{content:l.join(""),type:o}])?a(t,l,s,o):(0===e.length&&r&&(e.push(r),n.shift()),[{content:e.join(""),type:o},{content:n.join(""),type:o}])}function l(t,e){if(t.some((({content:t})=>t.includes("\n"))))throw new Error("splitLineToFitWidth does not support newlines in the line");return i(t,e)}function i(t,e,n=[],o=[]){if(0===t.length)return o.length>0&&n.push(o),n.length>0?n:[];let r="";" "===t[0].content&&(r=" ",t.shift());const a=t.shift()??{content:" ",type:"normal"},l=[...o];if(""!==r&&l.push({content:r,type:"normal"}),l.push(a),e(l))return i(t,e,n,l);if(o.length>0)n.push(o),t.unshift(a);else if(a.content){const[o,r]=s(e,a);n.push([o]),r.content&&t.unshift(r)}return i(t,e,n)}function c(t,e,n){return t.append("tspan").attr("class","text-outer-tspan").attr("x",0).attr("y",e*n-.1+"em").attr("dy",n+"em")}function p(t,e,n){const o=t.append("text"),r=c(o,1,e);u(r,n);const s=r.node().getComputedTextLength();return o.remove(),s}function h(t,e,n){var o;const r=t.append("text"),s=c(r,1,e);u(s,[{content:n,type:"normal"}]);const a=null==(o=s.node())?void 0:o.getBoundingClientRect();return a&&r.remove(),a}function u(t,e){t.text(""),e.forEach(((e,n)=>{const o=t.append("tspan").attr("font-style","emphasis"===e.type?"italic":"normal").attr("class","text-inner-tspan").attr("font-weight","strong"===e.type?"bold":"normal");0===n?o.text(e.content):o.text(" "+e.content)}))}const d=(o,s="",{style:a="",isTitle:i=!1,classes:h="",useHtmlLabels:d=!0,isNode:f=!0,width:y=200,addSvgBackground:g=!1}={})=>{if(t.info("createText",s,a,i,h,d,f,g),d){const t=function(t){const{children:e}=n(t);return e.map((function t(e){return"text"===e.type?e.value.replace(/\n/g,"<br/>"):"strong"===e.type?`<strong>${e.children.map(t).join("")}</strong>`:"emphasis"===e.type?`<em>${e.children.map(t).join("")}</em>`:"paragraph"===e.type?`<p>${e.children.map(t).join("")}</p>`:`Unsupported markdown: ${e.type}`})).join("")}(s),r=function(t,e,n,o,r=!1){const s=t.append("foreignObject"),a=s.append("xhtml:div"),l=e.label,i=e.isNode?"nodeLabel":"edgeLabel";var c,p;a.html(`\n    <span class="${i} ${o}" `+(e.labelStyle?'style="'+e.labelStyle+'"':"")+">"+l+"</span>"),c=a,(p=e.labelStyle)&&c.attr("style",p),a.style("display","table-cell"),a.style("white-space","nowrap"),a.style("max-width",n+"px"),a.attr("xmlns","http://www.w3.org/1999/xhtml"),r&&a.attr("class","labelBkg");let h=a.node().getBoundingClientRect();return h.width===n&&(a.style("display","table"),a.style("white-space","break-spaces"),a.style("width",n+"px"),h=a.node().getBoundingClientRect()),s.style("width",h.width),s.style("height",h.height),s.node()}(o,{isNode:f,label:e(t).replace(/fa[blrs]?:fa-[\w-]+/g,(t=>`<i class='${t.replace(":"," ")}'></i>`)),labelStyle:a.replace("fill:","color:")},y,h,g);return r}{const t=function(t,e,n,o=!1){const r=e.append("g"),s=r.insert("rect").attr("class","background"),a=r.append("text").attr("y","-10.1");let i=0;for(const h of n){const e=e=>p(r,1.1,e)<=t,n=e(h)?[h]:l(h,e);for(const t of n)u(c(a,i,1.1),t),i++}if(o){const t=a.node().getBBox(),e=2;return s.attr("x",-e).attr("y",-e).attr("width",t.width+2*e).attr("height",t.height+2*e),r.node()}return a.node()}(y,o,r(s),g);return t}};export{h as a,d as c};
//# sourceMappingURL=createText-2e5e7dd3-e84a7774.js.map
